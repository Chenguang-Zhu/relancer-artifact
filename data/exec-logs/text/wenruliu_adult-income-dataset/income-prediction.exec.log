
   age  workclass  fnlwgt  ... hours-per-week  native-country income
0   25    Private  226802  ...             40   United-States  <=50K
1   38    Private   89814  ...             50   United-States  <=50K
2   28  Local-gov  336951  ...             40   United-States   >50K
3   44    Private  160323  ...             40   United-States   >50K
4   18          ?  103497  ...             30   United-States  <=50K

[5 rows x 15 columns]
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 48842 entries, 0 to 48841
Data columns (total 15 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   age              48842 non-null  int64 
 1   workclass        48842 non-null  object
 2   fnlwgt           48842 non-null  int64 
 3   education        48842 non-null  object
 4   educational-num  48842 non-null  int64 
 5   marital-status   48842 non-null  object
 6   occupation       48842 non-null  object
 7   relationship     48842 non-null  object
 8   race             48842 non-null  object
 9   gender           48842 non-null  object
 10  capital-gain     48842 non-null  int64 
 11  capital-loss     48842 non-null  int64 
 12  hours-per-week   48842 non-null  int64 
 13  native-country   48842 non-null  object
 14  income           48842 non-null  object
dtypes: int64(6), object(9)
memory usage: 5.6+ MB
0    37155
1    11687
Name: income, dtype: int64
United-States    43832
Mexico             951
?                  857
Philippines        295
Germany            206
Puerto-Rico        184
Canada             182
El-Salvador        155
India              151
Cuba               138
Name: native-country, dtype: int64
United-States    43832
others            5010
Name: native-country, dtype: int64
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 48842 entries, 0 to 48841
Data columns (total 15 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   age              48842 non-null  int64 
 1   workclass        48842 non-null  object
 2   fnlwgt           48842 non-null  int64 
 3   education        48842 non-null  object
 4   educational-num  48842 non-null  int64 
 5   marital-status   48842 non-null  object
 6   occupation       48842 non-null  object
 7   relationship     48842 non-null  object
 8   race             48842 non-null  object
 9   gender           48842 non-null  object
 10  capital-gain     48842 non-null  int64 
 11  capital-loss     48842 non-null  int64 
 12  hours-per-week   48842 non-null  int64 
 13  native-country   48842 non-null  object
 14  income           48842 non-null  int64 
dtypes: int64(7), object(8)
memory usage: 5.6+ MB
       age     workclass  fnlwgt  ... capital-loss  hours-per-week native-country
0       25       Private  226802  ...            0              40  United-States
1       38       Private   89814  ...            0              50  United-States
2       28     Local-gov  336951  ...            0              40  United-States
3       44       Private  160323  ...            0              40  United-States
4       18             ?  103497  ...            0              30  United-States
...    ...           ...     ...  ...          ...             ...            ...
48837   27       Private  257302  ...            0              38  United-States
48838   40       Private  154374  ...            0              40  United-States
48839   58       Private  151910  ...            0              40  United-States
48840   22       Private  201490  ...            0              20  United-States
48841   52  Self-emp-inc  287927  ...            0              40  United-States

[48842 rows x 14 columns]
0        0
1        0
2        1
3        1
4        0
        ..
48837    0
48838    1
48839    0
48840    0
48841    1
Name: income, Length: 48842, dtype: int64
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 48842 entries, 0 to 48841
Data columns (total 15 columns):
 #   Column           Non-Null Count  Dtype 
---  ------           --------------  ----- 
 0   age              48842 non-null  int64 
 1   workclass        48842 non-null  object
 2   fnlwgt           48842 non-null  int64 
 3   education        48842 non-null  object
 4   educational-num  48842 non-null  int64 
 5   marital-status   48842 non-null  object
 6   occupation       48842 non-null  object
 7   relationship     48842 non-null  object
 8   race             48842 non-null  object
 9   gender           48842 non-null  object
 10  capital-gain     48842 non-null  int64 
 11  capital-loss     48842 non-null  int64 
 12  hours-per-week   48842 non-null  int64 
 13  native-country   48842 non-null  object
 14  income           48842 non-null  int64 
dtypes: int64(7), object(8)
memory usage: 5.6+ MB
   age  fnlwgt  educational-num  ...  race_White  gender_Male  native-country_others
0   25  226802                7  ...           0            1                      0
1   38   89814                9  ...           1            1                      0
2   28  336951               12  ...           1            1                      0
3   44  160323               10  ...           0            1                      0
4   18  103497               10  ...           1            0                      0

[5 rows x 60 columns]
0    0
1    0
2    1
3    1
4    0
Name: income, dtype: int64
<class 'pandas.core.frame.DataFrame'>
Int64Index: 36631 entries, 35805 to 2732
Data columns (total 60 columns):
 #   Column                                Non-Null Count  Dtype
---  ------                                --------------  -----
 0   age                                   36631 non-null  int64
 1   fnlwgt                                36631 non-null  int64
 2   educational-num                       36631 non-null  int64
 3   capital-gain                          36631 non-null  int64
 4   capital-loss                          36631 non-null  int64
 5   hours-per-week                        36631 non-null  int64
 6   workclass_Federal-gov                 36631 non-null  uint8
 7   workclass_Local-gov                   36631 non-null  uint8
 8   workclass_Never-worked                36631 non-null  uint8
 9   workclass_Private                     36631 non-null  uint8
 10  workclass_Self-emp-inc                36631 non-null  uint8
 11  workclass_Self-emp-not-inc            36631 non-null  uint8
 12  workclass_State-gov                   36631 non-null  uint8
 13  workclass_Without-pay                 36631 non-null  uint8
 14  education_11th                        36631 non-null  uint8
 15  education_12th                        36631 non-null  uint8
 16  education_1st-4th                     36631 non-null  uint8
 17  education_5th-6th                     36631 non-null  uint8
 18  education_7th-8th                     36631 non-null  uint8
 19  education_9th                         36631 non-null  uint8
 20  education_Assoc-acdm                  36631 non-null  uint8
 21  education_Assoc-voc                   36631 non-null  uint8
 22  education_Bachelors                   36631 non-null  uint8
 23  education_Doctorate                   36631 non-null  uint8
 24  education_HS-grad                     36631 non-null  uint8
 25  education_Masters                     36631 non-null  uint8
 26  education_Preschool                   36631 non-null  uint8
 27  education_Prof-school                 36631 non-null  uint8
 28  education_Some-college                36631 non-null  uint8
 29  marital-status_Married-AF-spouse      36631 non-null  uint8
 30  marital-status_Married-civ-spouse     36631 non-null  uint8
 31  marital-status_Married-spouse-absent  36631 non-null  uint8
 32  marital-status_Never-married          36631 non-null  uint8
 33  marital-status_Separated              36631 non-null  uint8
 34  marital-status_Widowed                36631 non-null  uint8
 35  occupation_Adm-clerical               36631 non-null  uint8
 36  occupation_Armed-Forces               36631 non-null  uint8
 37  occupation_Craft-repair               36631 non-null  uint8
 38  occupation_Exec-managerial            36631 non-null  uint8
 39  occupation_Farming-fishing            36631 non-null  uint8
 40  occupation_Handlers-cleaners          36631 non-null  uint8
 41  occupation_Machine-op-inspct          36631 non-null  uint8
 42  occupation_Other-service              36631 non-null  uint8
 43  occupation_Priv-house-serv            36631 non-null  uint8
 44  occupation_Prof-specialty             36631 non-null  uint8
 45  occupation_Protective-serv            36631 non-null  uint8
 46  occupation_Sales                      36631 non-null  uint8
 47  occupation_Tech-support               36631 non-null  uint8
 48  occupation_Transport-moving           36631 non-null  uint8
 49  relationship_Not-in-family            36631 non-null  uint8
 50  relationship_Other-relative           36631 non-null  uint8
 51  relationship_Own-child                36631 non-null  uint8
 52  relationship_Unmarried                36631 non-null  uint8
 53  relationship_Wife                     36631 non-null  uint8
 54  race_Asian-Pac-Islander               36631 non-null  uint8
 55  race_Black                            36631 non-null  uint8
 56  race_Other                            36631 non-null  uint8
 57  race_White                            36631 non-null  uint8
 58  gender_Male                           36631 non-null  uint8
 59  native-country_others                 36631 non-null  uint8
dtypes: int64(6), uint8(54)
memory usage: 3.8 MB
/home/cgzhu/anaconda3/envs/migration-plus/lib/python3.6/site-packages/statsmodels/base/model.py:568: ConvergenceWarning: Maximum Likelihood optimization failed to converge. Check mle_retvals
  "Check mle_retvals", ConvergenceWarning)
/home/cgzhu/anaconda3/envs/migration-plus/lib/python3.6/site-packages/statsmodels/base/model.py:1354: RuntimeWarning: invalid value encountered in sqrt
  bse_ = np.sqrt(np.diag(self.cov_params()))
/home/cgzhu/anaconda3/envs/migration-plus/lib/python3.6/site-packages/scipy/stats/_distn_infrastructure.py:1932: RuntimeWarning: invalid value encountered in less_equal
  cond2 = cond0 & (x <= _a)
/home/cgzhu/anaconda3/envs/migration-plus/lib/python3.6/site-packages/sklearn/model_selection/_split.py:297: FutureWarning: Setting a random_state has no effect since shuffle is False. This will raise an error in 0.24. You should leave random_state to its default (None), or set shuffle=True.
  FutureWarning
Warning: Maximum number of iterations has been exceeded.
         Current function value: 0.317197
         Iterations: 35
                           Logit Regression Results                           
==============================================================================
Dep. Variable:                 income   No. Observations:                48842
Model:                          Logit   Df Residuals:                    48783
Method:                           MLE   Df Model:                           58
Date:                Mon, 05 Jul 2021   Pseudo R-squ.:                  0.4235
Time:                        05:07:12   Log-Likelihood:                -15493.
converged:                      False   LL-Null:                       -26875.
Covariance Type:            nonrobust   LLR p-value:                     0.000
========================================================================================================
                                           coef    std err          z      P>|z|      [0.025      0.975]
--------------------------------------------------------------------------------------------------------
age                                      0.0255      0.001     19.083      0.000       0.023       0.028
fnlwgt                                6.928e-07   1.39e-07      4.997      0.000    4.21e-07    9.65e-07
educational-num                         -1.4478      0.057    -25.564      0.000      -1.559      -1.337
capital-gain                             0.0003   8.44e-06     37.583      0.000       0.000       0.000
capital-loss                             0.0006   3.02e-05     21.360      0.000       0.001       0.001
hours-per-week                           0.0288      0.001     22.041      0.000       0.026       0.031
workclass_Federal-gov                    0.9822        nan        nan        nan         nan         nan
workclass_Local-gov                      0.3428        nan        nan        nan         nan         nan
workclass_Never-worked                 -13.7247   2427.424     -0.006      0.995   -4771.389    4743.940
workclass_Private                        0.4900        nan        nan        nan         nan         nan
workclass_Self-emp-inc                   0.6362        nan        nan        nan         nan         nan
workclass_Self-emp-not-inc              -0.0518        nan        nan        nan         nan         nan
workclass_State-gov                      0.1695        nan        nan        nan         nan         nan
workclass_Without-pay                   -0.3980        nan        nan        nan         nan         nan
education_11th                           1.5425      0.197      7.844      0.000       1.157       1.928
education_12th                           3.4231      0.263     12.991      0.000       2.907       3.940
education_1st-4th                       -6.5175      0.443    -14.703      0.000      -7.386      -5.649
education_5th-6th                       -4.6003      0.277    -16.613      0.000      -5.143      -4.058
education_7th-8th                       -3.3012      0.196    -16.844      0.000      -3.685      -2.917
education_9th                           -1.6898      0.209     -8.073      0.000      -2.100      -1.280
education_Assoc-acdm                    10.1547      0.412     24.649      0.000       9.347      10.962
education_Assoc-voc                      8.6128      0.358     24.081      0.000       7.912       9.314
education_Bachelors                     12.1363      0.462     26.293      0.000      11.232      13.041
education_Doctorate                     17.3803      0.637     27.263      0.000      16.131      18.630
education_HS-grad                        5.2210      0.248     21.078      0.000       4.735       5.706
education_Masters                       13.9103      0.518     26.854      0.000      12.895      14.926
education_Preschool                    -12.4287      3.974     -3.127      0.002     -20.218      -4.640
education_Prof-school                   15.8660      0.580     27.345      0.000      14.729      17.003
education_Some-college                   7.0338      0.300     23.417      0.000       6.445       7.623
marital-status_Married-AF-spouse         2.4767      0.459      5.401      0.000       1.578       3.375
marital-status_Married-civ-spouse        2.3550      0.215     10.934      0.000       1.933       2.777
marital-status_Married-spouse-absent     0.1562      0.178      0.876      0.381      -0.193       0.506
marital-status_Never-married            -0.4226      0.072     -5.900      0.000      -0.563      -0.282
marital-status_Separated                -0.0555      0.134     -0.415      0.678      -0.317       0.206
marital-status_Widowed                   0.0709      0.126      0.563      0.574      -0.176       0.318
occupation_Adm-clerical                  0.2728        nan        nan        nan         nan         nan
occupation_Armed-Forces                  0.8455        nan        nan        nan         nan         nan
occupation_Craft-repair                  0.3453        nan        nan        nan         nan         nan
occupation_Exec-managerial               1.0421        nan        nan        nan         nan         nan
occupation_Farming-fishing              -0.6872        nan        nan        nan         nan         nan
occupation_Handlers-cleaners            -0.4084        nan        nan        nan         nan         nan
occupation_Machine-op-inspct            -0.0312        nan        nan        nan         nan         nan
occupation_Other-service                -0.6042        nan        nan        nan         nan         nan
occupation_Priv-house-serv              -1.7203        nan        nan        nan         nan         nan
occupation_Prof-specialty                0.8106        nan        nan        nan         nan         nan
occupation_Protective-serv               0.7630        nan        nan        nan         nan         nan
occupation_Sales                         0.5286        nan        nan        nan         nan         nan
occupation_Tech-support                  0.8398        nan        nan        nan         nan         nan
occupation_Transport-moving              0.1745        nan        nan        nan         nan         nan
relationship_Not-in-family               0.5937      0.213      2.786      0.005       0.176       1.011
relationship_Other-relative             -0.5053      0.197     -2.564      0.010      -0.892      -0.119
relationship_Own-child                  -0.5128      0.209     -2.456      0.014      -0.922      -0.104
relationship_Unmarried                   0.4024      0.227      1.774      0.076      -0.042       0.847
relationship_Wife                        1.1387      0.083     13.738      0.000       0.976       1.301
race_Asian-Pac-Islander                  0.5791      0.199      2.909      0.004       0.189       0.969
race_Black                               0.2771      0.187      1.482      0.138      -0.089       0.644
race_Other                               0.3263      0.265      1.230      0.219      -0.194       0.846
race_White                               0.5200      0.178      2.926      0.003       0.172       0.868
gender_Male                              0.7044      0.064     11.055      0.000       0.580       0.829
native-country_others                   -0.2392      0.058     -4.138      0.000      -0.352      -0.126
========================================================================================================
Accuracy of logistic regression classifier on test set: 0.85
10-fold cross validation average accuracy: 0.852
[[8645  628]
 [1173 1765]]
              precision    recall  f1-score   support

           0       0.88      0.93      0.91      9273
           1       0.74      0.60      0.66      2938

    accuracy                           0.85     12211
   macro avg       0.81      0.77      0.78     12211
weighted avg       0.85      0.85      0.85     12211


